alert_config:
  - name: Test Alert 4
    config:
      scope: phy_interface
      source: grafana
      tags: [ neteng, bb, test ]
      severity: INFO
      auto_expire: true
      expire_after: 15m
      outputs: [ slack ]
      escalation_rules:
        - after: 5m
          escalate_to: WARN
        - after: 10m
          escalate_to: CRITICAL
          send_to: [ victorops ]
      # for: 15m # alert only if it keeps firing for 15 min

  - name: Neteng BGP Down
    config:
      scope: bgp_peer
      source: observium
      tags: [ neteng, bgpdown ]
      severity: INFO
      aggregation_rules:
        - dc_circuit_down
        - bgp_session

aggregation_rules:
  - name: bgp_session
    window: 1m
    alert:
      name: Neteng_Aggregated BGP Down
      config:
        source: bgp_session
        severity: WARN
        tags: [ neteng, bgp ]
        auto_expire: true  ## aggregated alert will expire only when all component alerts expire
        outputs: [ slack ]

inhibit_rules:
    - name: Device down
      source_match:
        alert: Neteng Device Down
        label: Name
      target_matches:
        - alert: Neteng BGP Down
          label: RemoteDeviceName
        - alert: Neteng DC Link Down
          label: ZSideDeviceName
        - alert: Neteng BB Link Down
          label: ZSideDeviceName
